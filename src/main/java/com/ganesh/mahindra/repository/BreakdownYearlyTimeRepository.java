package com.ganesh.mahindra.repository;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

import com.ganesh.mahindra.model.BreakdownTimeYearly;
@Repository
public interface BreakdownYearlyTimeRepository extends JpaRepository<BreakdownTimeYearly, Integer> {

	//@Query(value="select SUM(1) as id,coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0) as first_year_time, coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) as second_year_time, coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) as third_year_time, coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0) as fourth_year_time ,coalesce((select count(*) as breakdown_count1 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0) as first_year, coalesce((select count(*) as breakdown_count2 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) as second_year, coalesce((select count(*) as breakdown_count3 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) as third_year, coalesce((select count(*) as breakdown_count4 from why_why_f18 where bd_ms_pt='BD' and rank!=1  and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0) as fourth_year  from why_why_f18",nativeQuery=true)
	@Query(value="select SUM(1) as id,coalesce((CASE WHEN (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromFirst) else  (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)) END),0) as first_year_time, coalesce((CASE WHEN (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromSecond) else  (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0))END),0) as second_year_time, coalesce((CASE WHEN (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromThird) else  (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0)) END),0) as third_year_time, coalesce((CASE WHEN (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromFourth) else  (coalesce((select SUM(bd_time_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0)) END),0)  as fourth_year_time ,coalesce((CASE WHEN (coalesce((select count(*) as breakdown_count1 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromFirst) else (coalesce((select count(*) as breakdown_count1 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)) END),0) as first_year, coalesce((CASE WHEN (coalesce((select count(*) as breakdown_count2 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) <=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromSecond) else (coalesce((select count(*) as breakdown_count2 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0)) END),0) as second_year, coalesce((CASE WHEN (coalesce((select count(*) as breakdown_count3 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromThird) else (coalesce((select count(*) as breakdown_count3 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0)) END),0) as third_year, coalesce((CASE WHEN (coalesce((select count(*) as breakdown_count4 from why_why_f18 where bd_ms_pt='BD' and rank!=1  and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=4 and status=1 and ex_int=:deptId and year=:fromFourth) else (coalesce((select count(*) as breakdown_count4 from why_why_f18 where bd_ms_pt='BD' and rank!=1  and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0)) END),0) as fourth_year  from why_why_f18",nativeQuery=true)
	BreakdownTimeYearly getAllBrekYearwiseBreakdownTime(@Param("fromFirst") String fromFirst,@Param("fromSecond") String fromSecond,@Param("fromThird") String fromThird,@Param("fromFourth") String fromFourth,@Param("fromFirstYear") String fromFirstYear,@Param("toFirstYear") String toFirstYear,
			@Param("fromSecondYear")String fromSecondYear,@Param("toSecondYear") String toSecondYear, @Param("fromThirdYear")String fromThirdYear,@Param("toThirdYear") String toThirdYear,@Param("fromFourthYear") String fromFourthYear,
			@Param("toFourthYear")String toFourthYear,@Param("deptId")int deptId);

	//@Query(value="select SUM(1) as id,coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0) as first_year_time, coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) as second_year_time, coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) as third_year_time, coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0) as fourth_year_time ,coalesce((select count(*) as breakdown_count1 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0) as first_year, coalesce((select count(*) as breakdown_count2 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) as second_year, coalesce((select count(*) as breakdown_count3 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) as third_year, coalesce((select count(*) as breakdown_count4 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0) as fourth_year  from why_why_f18",nativeQuery=true)
	@Query(value="select SUM(1) as id,coalesce((CASE WHEN (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=7 and status=1 and ex_int=:deptId and year=:fromFirst) else (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0)) END),0) as first_year_time,coalesce((CASE WHEN (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=7 and status=1 and ex_int=:deptId and year=:fromSecond) else (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0)) END),0)  as second_year_time,coalesce((CASE WHEN (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) <=0) THEN (select ex_string from mac_breakdown_target where graph_type=7 and status=1 and ex_int=:deptId and year=:fromThird) else (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) ) END),0) as third_year_time,coalesce((CASE WHEN (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear),0)<=0) THEN (select ex_string from mac_breakdown_target where graph_type=7 and status=1 and ex_int=:deptId and year=:fromFourth) else (coalesce((select SUM(engine_loss)  from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0)) END),0) as fourth_year_time ,coalesce((select count(*) as breakdown_count1 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFirstYear and :toFirstYear ),0) as first_year, coalesce((select count(*) as breakdown_count2 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromSecondYear and :toSecondYear ),0) as second_year, coalesce((select count(*) as breakdown_count3 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromThirdYear and :toThirdYear ),0) as third_year, coalesce((select count(*) as breakdown_count4 from why_why_f18 where bd_ms_pt='BD' and rank!=1 and dept=:deptId and date between :fromFourthYear and :toFourthYear ),0) as fourth_year  from why_why_f18",nativeQuery=true)
	BreakdownTimeYearly getAllBrekYearwiseBreakdownELoss(@Param("fromFirst") String fromFirst,@Param("fromSecond") String fromSecond,@Param("fromThird") String fromThird,@Param("fromFourth") String fromFourth,@Param("fromFirstYear") String fromFirstYear,@Param("toFirstYear") String toFirstYear,
			@Param("fromSecondYear")String fromSecondYear,@Param("toSecondYear") String toSecondYear, @Param("fromThirdYear")String fromThirdYear,@Param("toThirdYear") String toThirdYear,@Param("fromFourthYear") String fromFourthYear,
			@Param("toFourthYear")String toFourthYear,@Param("deptId")int deptId);

}
